<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Resume Parsing Result</title>
    <!-- CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css" integrity="sha512-Kc323vGBEqzTmouAECnVceyQqyqdsSiqLQISBL29aUW4U/M7pSPA/gEUZQqv1cwx4OnYxTxve5UMg5GT6L4JJg==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <style>
        .result-box {
            background: url('https://img.freepik.com/free-vector/paper-style-white-monochrome-background_52683-66443.jpg?t=st=1733027945~exp=1733031545~hmac=f24c6e858babe810f0408579362bddccb4d16c9f9c024ba97071652ca9fcff02&w=1060') no-repeat center center fixed;
            background-size: cover;  
            color: #333;  
            position: sticky;
        }

        .result-box:before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.15);  
            z-index: -1;  
        }
    </style>
</head>
<body>
    <div class="result-box">
        <div class="container  pt-5">
            <h1 class="text-center">Resume Parsing Results</h1>
        
            {% if data %}
            <div class="mt-4">
                <div class="resume-summary mb-4">
                    <h3>Resume Summary</h3>
                    <p><strong>Name:</strong> {{ data.name }}</p>
                    <p><strong>Email:</strong> {{ data.email }}</p>
                    <p><strong>Phone:</strong> {{ data.phone }}</p>
                    <p><strong>Location:</strong> {{ data.location }}</p>
                </div>

                <!-- Scores Section -->
                <h3>Scores Overview</h3>
                <div class="row justify-content-center">
                    <div class="col-md-5">
                        <div class="score-card">
                            <i class="fas fa-tools"></i>
                            <h5>Skills Match</h5>
                            <div class="progress">
                                <div class="progress-bar bg-success" role="progressbar" style="width: {{ data.skills_match * 100 }}%;" aria-valuenow="{{ data.skills_match * 100 }}" aria-valuemin="0" aria-valuemax="100">
                                    {{ "%.2f" | format(data.skills_match * 100) }}%
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-5">
                        <div class="score-card">
                            <i class="fas fa-briefcase"></i>
                            <h5>Experience Match</h5>
                            <div class="progress">
                                <div class="progress-bar bg-danger" role="progressbar" style="width: {{ data.experience_match * 100 }}%;" aria-valuenow="{{ data.experience_match * 100 }}" aria-valuemin="0" aria-valuemax="100">
                                    {{ data.experience_match | round(2) * 100 }}%
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-5">
                        <div class="score-card">
                            <i class="fas fa-graduation-cap"></i>
                            <h5>Education Match</h5>
                            <div class="progress">
                                <div class="progress-bar bg-danger" role="progressbar" style="width: {{ data.education_match * 100 }}%;" aria-valuenow="{{ data.education_match * 100 }}" aria-valuemin="0" aria-valuemax="100">
                                    {{ data.education_match | round(2) * 100 }}%
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-5">
                        <div class="score-card">
                            <i class="fas fa-id-card-alt"></i>
                            <h5>Job Title Relevance</h5>
                            <div class="progress">
                                <div class="progress-bar bg-warning" role="progressbar" style="width: {{ data.job_title_relevance * 100 }}%;" aria-valuenow="{{ data.job_title_relevance * 100 }}" aria-valuemin="0" aria-valuemax="100">
                                    {{ data.job_title_relevance | round(2) * 100 }}%
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-5">
                        <div class="score-card">
                            <i class="fas fa-chart-pie"></i>
                            <h5>Overall Similarity</h5>
                            <div class="progress">
                                <div class="progress-bar bg-primary" role="progressbar" style="width: {{ data.overall_similarity * 100 }}%;" aria-valuenow="{{ data.overall_similarity * 100 }}" aria-valuemin="0" aria-valuemax="100">
                                    {{ data.overall_similarity | round(2) * 100 }}%
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
    
                <!-- Matching Skills Section -->
                <h3 class="mt-4">Matching Skills</h3>
                <div class="mt-2">
                    {% for skill in data.matching_skills %}
                        <span class="skill-box green">{{ skill }}</span>
                    {% endfor %}
                </div>
    
                <!-- Missing Skills Section -->
                <h3 class="mt-4">Missing Skills</h3>
                <div class="mt-2">
                    {% for skill in data.missing_skills %}
                        <span class="skill-box red">{{ skill }}</span>
                    {% endfor %}
                </div>
        
                <!-- Total Score Section -->
                <div class="mt-4 text-center">
                    <h3>Total Score</h3>
                    <h1 class="text-primary">{{ data.total_score | round(2) * 100 }}%</h1>
                </div>
    
                <!-- Resume Extracted Data Section -->
                <h3 class="mt-4">Resume Extracted Data</h3>
                <iframe id="resumeIframe" style="width: 100%; border: none;" scrolling="no"></iframe>
    
                <!-- JD Extracted Data Section -->
                <h3 class="mt-4">Job Description Extracted Data</h3>
                <iframe id="jobIframe" style="width: 100%; border: none;" scrolling="no"></iframe>
    
    
            </div>
            {% else %}
            <p class="text-center text-danger">No results to display. Please try again.</p>
            {% endif %}
        
            <!-- Button to Upload Another -->
            <div class="text-center py-5">
                <a href="/" class="btn btn-primary btn-md px-4 py-3">Upload Another Resume </a>
            </div>
        </div>
    </div>

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script>
    // Function to adjust iframe height based on its content
    function adjustIframeHeight(iframe) {
        var iframeDoc = iframe.contentDocument || iframe.contentWindow.document;
        iframe.style.height = iframeDoc.documentElement.scrollHeight + "px";  // Adjust iframe height to content height
    }

    // Function to inject content and adjust iframe height
    function loadIframeContent(iframe, content) {
        var iframeDoc = iframe.contentDocument || iframe.contentWindow.document;
        iframeDoc.open();
        iframeDoc.write(content); // Inject the content into iframe
        iframeDoc.close();
        adjustIframeHeight(iframe); // Adjust height after content is loaded
    }

    // Example data (Replace with actual dynamic data)
    var resumeHtml = `{{ data.resume_ner[0] | safe }}`;  // Inject resume data
    var jobHtml = `{{ data.job_ner[0] | safe }}`;      // Inject job data

    var resumeIframe = document.getElementById('resumeIframe');
    var jobIframe = document.getElementById('jobIframe');

    // Load content into the resume iframe and adjust height
    loadIframeContent(resumeIframe, resumeHtml);

    // Load content into the job iframe and adjust height
    loadIframeContent(jobIframe, jobHtml);
</script>
</body>
</html>
